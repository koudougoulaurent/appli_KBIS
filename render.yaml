services:
  # Service web principal
  - type: web
    name: appli-kbis
    env: python
    plan: free
    buildCommand: |
      pip install -r requirements_render.txt
      python manage.py collectstatic --noinput --settings=gestion_immobiliere.settings_render
      python manage.py migrate --settings=gestion_immobiliere.settings_render
      python commande_rapide_render.py
    startCommand: gunicorn gestion_immobiliere.wsgi:application
    envVars:
      - key: DJANGO_SETTINGS_MODULE
        value: gestion_immobiliere.settings_render
      - key: DEBUG
        value: False
      - key: SECRET_KEY
        generateValue: true
      - key: ALLOWED_HOSTS
        value: appli-kbis.onrender.com,.onrender.com
    healthCheckPath: /

  # Base de donn√©es PostgreSQL
  - type: pserv
    name: appli-kbis-db
    env: postgresql
    plan: free
    region: oregon
    databaseName: appli_kbis
    databaseUser: appli_kbis_user
