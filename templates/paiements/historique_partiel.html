{% extends 'base.html' %}
{% block content %}
<h2>Historique des paiements partiels</h2>
<p>Contrat : {{ contrat.numero_contrat }}<br>
Mois : {{ mois }}/{{ annee }}<br>
Montant dû : {{ montant_du_mois }} F CFA</p>
<p>Statut : <strong>{{ statut|title }}</strong></p>
<p>Total payé : {{ total_paye }} F CFA<br>
Montant restant : {{ montant_restant }} F CFA</p>
<table class="table table-bordered">
    <thead>
        <tr>
            <th>Date</th>
            <th>Montant</th>
            <th>Statut</th>
            <th>Mode</th>
            <th>Référence</th>
        </tr>
    </thead>
    <tbody>
        {% for paiement in paiements %}
        <tr>
            <td>{{ paiement.date_paiement|date:"d/m/Y" }}</td>
            <td>{{ paiement.montant }} F CFA</td>
            <td>{{ paiement.get_statut_display }}</td>
            <td>{{ paiement.get_mode_paiement_display }}</td>
            <td>{{ paiement.reference_paiement }}</td>
        </tr>
        {% empty %}
        <tr><td colspan="5">Aucun paiement enregistré.</td></tr>
        {% endfor %}
    </tbody>
</table>
{% if statut == 'valide' %}
    <p><strong>Le paiement est complet. Le reçu peut être généré.</strong></p>
{% else %}
    <p><strong>Paiement partiel : le reçu ne sera généré qu'une fois le montant total réglé.</strong></p>
{% endif %}
<a href="{% url 'paiements:ajouter' %}" class="btn btn-primary">Ajouter un paiement</a>
{% endblock %}