{% extends 'base_dashboard.html' %}
{% load static %}
{% load humanize %}

{% block title %}Récépissé de paiement - {{ quittance.numero_quittance }}{% endblock %}

{% block extra_css %}
<style>
    /* Styles pour l'impression A4 - Format optimisé */
    @media print {
        @page {
            size: A4;
            margin: 15mm;
        }
        
        .no-print {
            display: none !important;
        }
        
        /* Supprimer l'URL et les éléments de navigation du navigateur */
        @page {
            @bottom-right {
                content: none;
            }
        }
        
        body {
            font-size: 12px;
            line-height: 1.4;
            margin: 0;
            padding: 0;
        }
        
        .quittance-page {
            width: 100%;
            height: 100vh;
            margin: 0;
            padding: 0;
        }
        
        .quittance-container {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
            box-shadow: none;
            border: none;
            display: flex;
            flex-direction: column;
            position: relative;
        }
        
        .quittance-content {
            position: relative;
            z-index: 10;
            background: transparent;
        }
        
        /* Zones de contenu précisément positionnées */
        .content-zone {
            position: relative;
            width: 100%;
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        /* Suppression des en-têtes et pieds de page statiques pour éviter le chevauchement */
        
        .footer-content {
            text-align: center;
        }
        
        .footer-info {
            font-size: 8px;
            line-height: 1.2;
            text-align: center;
        }
        
        .footer-info p {
            margin: 1px 0;
            color: #2c3e50;
        }
        
        .footer-adresse {
            font-weight: 600;
            font-size: 9px;
        }
        
        .footer-contact {
            font-size: 8px;
            color: #7f8c8d;
        }
        
        .footer-legal {
            font-size: 7px;
            color: #95a5a6;
            margin-top: 3px;
        }
        
        /* Zone de contenu principal - Format A5 */
        .quittance-main-content {
            margin-top: 80px; /* Espace pour l'en-tête fixe */
            margin-bottom: 60px; /* Espace pour le pied de page fixe */
            padding: 10px;
            min-height: calc(100vh - 140px);
        }
        
        /* Format A5 */
        .quittance-page {
            width: 148mm; /* A5 width */
            min-height: 210mm; /* A5 height */
            margin: 0 auto;
            background: white;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        
        /* Layout principal en deux colonnes - Format A5 compact */
        .quittance-main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
            padding: 10px;
        }
        
        .quittance-left-column {
            padding-right: 10px;
        }
        
        .quittance-right-column {
            padding-left: 10px;
        }
        
        .quittance-info p {
            margin: 4px 0;
            font-size: 11px;
            color: #2c3e50;
        }
        
        .agency-stamp {
            margin-top: 15px;
        }
        
        .agency-stamp p {
            font-size: 10px;
            margin-bottom: 5px;
            color: #2c3e50;
        }
        
        .stamp-placeholder {
            display: flex;
            justify-content: center;
            margin-top: 5px;
        }
        
        .stamp-circle {
            width: 60px;
            height: 60px;
            border: 2px solid #3498db;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f8f9fa;
        }
        
        .stamp-text {
            text-align: center;
            font-size: 7px;
            color: #2c3e50;
            line-height: 1.1;
        }
        
        .quittance-details p {
            margin: 4px 0;
            font-size: 11px;
            color: #2c3e50;
        }
        
        .amount-section {
            margin: 10px 0;
        }
        
        .amount-box {
            border: 2px solid #2c3e50;
            padding: 8px;
            text-align: center;
            font-size: 14px;
            font-weight: bold;
            margin: 5px 0;
            background: #f8f9fa;
        }
        
        .amount-words {
            font-size: 9px;
            color: #7f8c8d;
            font-style: italic;
        }
        
        .payment-summary {
            margin-top: 10px;
        }
        
        .summary-row {
            display: flex;
            justify-content: space-between;
            margin: 3px 0;
            font-size: 10px;
            color: #2c3e50;
        }
        
        /* En-tête quittance - optimisé A4 */
        .quittance-header {
            margin-top: 0;
            margin-bottom: 20px;
            padding: 0 20mm;
            text-align: center;
            background: transparent;
        }
        
        .quittance-title {
            font-size: clamp(14px, 2.5vw, 18px);
            margin-bottom: 2mm;
            color: #2c3e50;
            font-weight: bold;
        }
        
        .quittance-number {
            font-size: clamp(10px, 1.8vw, 12px);
            color: #666;
            font-weight: 500;
        }
        
        .quittance-date {
            font-size: clamp(8px, 1.5vw, 10px);
            color: #888;
        }
        
        /* Sections - optimisées A4 */
        .quittance-section {
            margin: 5px 0;
            padding: 0 20mm;
            background: transparent;
        }
        
        .section-header {
            font-size: clamp(12px, 2vw, 14px);
            font-weight: bold;
            margin-bottom: 2mm;
            border-bottom: 1px solid #333;
            padding-bottom: 1mm;
        }
        
        .info-grid {
            display: flex;
            flex-direction: column;
            gap: 2mm;
            max-width: 100%;
        }
        
        .info-item {
            display: flex;
            flex-direction: row;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1mm;
            padding: 1mm 0;
            width: 100%;
            clear: both;
            min-height: 4mm;
        }
        
        .info-label {
            font-weight: bold;
            font-size: clamp(9px, 1.6vw, 11px);
            color: #333;
            font-family: Arial, sans-serif;
            min-width: 80px;
            text-align: left;
        }
        
        .info-value {
            font-size: clamp(9px, 1.6vw, 11px);
            color: #2c3e50;
            font-family: Arial, sans-serif;
            text-align: right;
            flex: 1;
        }
        
        /* Détails du paiement */
        .payment-details {
            margin: 5px 0;
            padding: 0 20mm;
            background: transparent;
        }
        
        .payment-info {
            display: flex;
            flex-direction: column;
            gap: 2mm;
            max-width: 100%;
        }
        
        .payment-info-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1mm;
            padding: 1mm 0;
            width: 100%;
            clear: both;
            min-height: 4mm;
        }
        
        .payment-info-label {
            font-weight: bold;
            font-size: clamp(9px, 1.6vw, 11px);
            color: #333;
            font-family: Arial, sans-serif;
            min-width: 80px;
            text-align: left;
        }
        
        .payment-info-value {
            font-size: clamp(9px, 1.6vw, 11px);
            color: #2c3e50;
            font-family: Arial, sans-serif;
            text-align: right;
            flex: 1;
        }
        
        /* Montant total */
        .amount-section {
            margin: 8px 0;
            padding: 0 20mm;
            text-align: center;
            background: transparent;
        }
        
        .amount-value {
            font-size: clamp(18px, 3.5vw, 24px);
            font-weight: bold;
            color: #2c3e50;
        }
        
        .amount-label {
            font-size: clamp(10px, 1.8vw, 12px);
            color: #666;
            margin-top: 1mm;
        }
        
        /* Pied de page - compact */
        .quittance-footer {
            margin-top: 30px;
            margin-bottom: 0;
            padding: 0 15mm;
            border-top: 2px solid #2c3e50;
            background: transparent;
            position: relative;
        }
        
        .signature-section {
            display: flex;
            justify-content: space-between;
            margin-bottom: 4mm;
        }
        
        .signature-box {
            width: 45%;
            text-align: center;
        }
        
        .signature-line {
            border-bottom: 1px solid #333;
            height: 20px;
            margin-bottom: 2mm;
        }
        
        .signature-label {
            font-size: 10px;
            color: #666;
        }
        
        .entreprise-footer {
            text-align: center;
            font-size: 9px;
            color: #666;
        }
        
        .entreprise-footer-info {
            line-height: 1.2;
        }
        
        /* Gestion des pages multiples */
        .quittance-page {
            page-break-after: always;
        }
        
        .quittance-page:last-child {
            page-break-after: avoid;
        }
        
        /* Page suivante avec même structure */
        .quittance-page + .quittance-page .quittance-container {
            margin-top: 0;
        }
        
        .quittance-page + .quittance-page .entreprise-header {
            margin-top: 0;
        }
    }

    /* Styles pour l'écran */
    .quittance-page {
        background: #f8f9fa;
        min-height: 100vh;
        padding: 2rem 0;
    }

    .quittance-container {
        max-width: 210mm;
        margin: 0 auto;
        background: white;
        border: 1px solid #ddd;
        overflow: hidden;
        min-height: 297mm;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        display: flex;
        flex-direction: column;
        position: relative;
    }
    
    .quittance-content {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        z-index: 10;
        display: flex;
        flex-direction: column;
        padding: 0;
        overflow: hidden;
    }
    
    /* Zones de contenu précisément positionnées */
    .content-zone {
        position: relative;
        width: 100%;
        flex: 1;
        display: flex;
        flex-direction: column;
    }

    /* En-tête de l'entreprise avec image - Style humain */
    .entreprise-header {
        background: white;
        padding: 0;
        text-align: center;
        border-bottom: 1px solid #ddd;
        flex-shrink: 0;
    }

    /* En-tête de l'entreprise dynamique - Écran - Style KBIS */
    .entreprise-header {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        width: 100%;
        padding: 25px 30px;
        background: white;
        color: #2c3e50;
        border-bottom: 3px solid #e74c3c;
        z-index: 1000;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    
    .header-content {
        text-align: center;
    }
    
    .nom-entreprise {
        font-size: 32px;
        font-weight: bold;
        margin: 0 0 15px 0;
        color: #2c3e50;
        text-transform: uppercase;
        letter-spacing: 1px;
    }
    
    .services-section {
        margin: 15px 0;
        font-size: 16px;
        color: #7f8c8d;
    }
    
    .services-list {
        list-style: none;
        padding: 0;
        margin: 8px 0;
        display: flex;
        justify-content: center;
        gap: 25px;
        flex-wrap: wrap;
    }
    
    .services-list li {
        position: relative;
    }
    
    .services-list li:not(:last-child)::after {
        content: "•";
        position: absolute;
        right: -15px;
        color: #e74c3c;
    }
    
    .orange-money {
        background: #ff6b35;
        color: white;
        padding: 8px 15px;
        border-radius: 6px;
        font-size: 14px;
        font-weight: bold;
        margin: 15px 0;
        display: inline-block;
    }
    
    .contact-info {
        font-size: 13px;
        line-height: 1.4;
        color: #7f8c8d;
        margin-top: 15px;
    }
    
    .contact-info p {
        margin: 3px 0;
    }
    
    /* Pied de page de l'entreprise dynamique - Écran - Style KBIS */
    .entreprise-footer {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        width: 100%;
        padding: 20px 30px;
        background: #f8f9fa;
        color: #2c3e50;
        border-top: 2px solid #e74c3c;
        z-index: 1000;
        box-shadow: 0 -4px 6px rgba(0, 0, 0, 0.1);
    }
    
    .footer-content {
        text-align: center;
    }
    
    .footer-info {
        font-size: 13px;
        line-height: 1.5;
    }
    
    .footer-info p {
        margin: 3px 0;
        color: #ecf0f1;
    }
    
    .footer-adresse, .footer-ville {
        font-weight: 500;
    }
    
    .footer-contact {
        font-size: 12px;
    }
    
    .footer-legal {
        font-size: 11px;
        color: #bdc3c7;
        margin-top: 8px;
    }

    /* Zone de contenu principal - Écran - Format A5 */
    .quittance-main-content {
        margin-top: 100px; /* Espace pour l'en-tête fixe */
        margin-bottom: 80px; /* Espace pour le pied de page fixe */
        padding: 15px;
        min-height: calc(100vh - 180px);
    }
    
    /* Format A5 - Écran */
    .quittance-page {
        width: 148mm; /* A5 width */
        min-height: 210mm; /* A5 height */
        margin: 0 auto;
        background: white;
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
    }
    
    /* Layout principal en deux colonnes - Écran - Format A5 compact */
    .quittance-main-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-bottom: 20px;
        padding: 15px;
    }
    
    .quittance-left-column {
        padding-right: 15px;
    }
    
    .quittance-right-column {
        padding-left: 15px;
    }
    
    .quittance-info p {
        margin: 6px 0;
        font-size: 13px;
        color: #2c3e50;
    }
    
    .agency-stamp {
        margin-top: 20px;
    }
    
    .agency-stamp p {
        font-size: 12px;
        margin-bottom: 8px;
        color: #2c3e50;
    }
    
    .stamp-circle {
        width: 80px;
        height: 80px;
        border: 3px solid #3498db;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        background: #f8f9fa;
    }
    
    .stamp-text {
        text-align: center;
        font-size: 9px;
        color: #2c3e50;
        line-height: 1.2;
    }
    
    .quittance-details p {
        margin: 6px 0;
        font-size: 13px;
        color: #2c3e50;
    }
    
    .amount-box {
        border: 2px solid #2c3e50;
        padding: 10px;
        text-align: center;
        font-size: 16px;
        font-weight: bold;
        margin: 8px 0;
        background: #f8f9fa;
    }
    
    .amount-words {
        font-size: 11px;
        color: #7f8c8d;
        font-style: italic;
    }
    
    .summary-row {
        display: flex;
        justify-content: space-between;
        margin: 4px 0;
        font-size: 12px;
        color: #2c3e50;
    }
    
    /* En-tête de la quittance - Style humain */
    .quittance-header {
        margin-top: 0;
        margin-bottom: 20px;
        padding: 0 20mm;
        text-align: center;
        border-bottom: none;
        background: transparent;
    }

    .quittance-title {
        font-size: 24px;
        font-weight: 600;
        margin-bottom: 4mm;
        color: #2c3e50;
        font-family: 'Times New Roman', serif;
    }

    .quittance-number {
        font-size: 14px;
        color: #666;
        margin-bottom: 2mm;
        font-family: 'Courier New', monospace;
        font-weight: 500;
    }

    .quittance-date {
        font-size: 12px;
        color: #888;
        font-family: Arial, sans-serif;
    }

    /* Sections - Style humain */
    .quittance-section {
        margin: 5px 0;
        padding: 0 20mm;
        border-bottom: none;
        background: transparent;
    }

    .section-header {
        font-size: 18px;
        font-weight: 600;
        margin-bottom: 8mm;
        color: #2c3e50;
        border-bottom: 2px solid #3498db;
        padding-bottom: 4mm;
        font-family: 'Times New Roman', serif;
    }

    .info-grid {
        display: flex;
        flex-direction: column;
        gap: 2mm;
        max-width: 100%;
    }

    .info-item {
        display: flex;
        flex-direction: row;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1mm;
        padding: 1mm 0;
        width: 100%;
        clear: both;
        min-height: 4mm;
    }

    .info-label {
        font-weight: 600;
        font-size: 12px;
        color: #333;
        margin-bottom: 0;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        font-family: Arial, sans-serif;
        min-width: 100px;
        text-align: left;
    }

    .info-value {
        font-size: 14px;
        color: #2c3e50;
        font-family: Arial, sans-serif;
        text-align: right;
        flex: 1;
    }

    /* Détails du paiement - Style humain */
    .payment-details {
        margin: 5px 0;
        padding: 0 20mm;
        border-bottom: none;
        background: transparent;
    }

    .payment-info {
        display: flex;
        flex-direction: column;
        gap: 2mm;
        max-width: 100%;
    }

    .payment-info-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1mm;
        padding: 1mm 0;
        background: transparent;
        border-radius: 0;
        width: 100%;
        clear: both;
        min-height: 4mm;
    }

    .payment-info-label {
        font-weight: 600;
        font-size: 12px;
        color: #333;
        font-family: Arial, sans-serif;
        min-width: 100px;
        text-align: left;
    }

    .payment-info-value {
        font-size: 14px;
        color: #2c3e50;
        font-weight: 500;
        font-family: Arial, sans-serif;
        text-align: right;
        flex: 1;
    }

    /* Montant total - Style humain */
    .amount-section {
        margin: 8px 0;
        padding: 0 20mm;
        text-align: center;
        background: transparent;
        color: #2c3e50;
        border-radius: 0;
    }

    .amount-value {
        font-size: 36px;
        font-weight: 700;
        margin-bottom: 4mm;
        font-family: 'Times New Roman', serif;
    }

    .amount-label {
        font-size: 16px;
        opacity: 0.9;
        font-family: Arial, sans-serif;
    }

    /* Pied de page avec signatures et entreprise - Style humain */
    .quittance-footer {
        position: absolute;
        bottom: 25mm;
        left: 0;
        right: 0;
        padding: 0 15mm;
        border-top: none;
        background: transparent;
        z-index: 20;
    }

    .signature-section {
        display: flex;
        justify-content: space-between;
        margin-bottom: 15mm;
    }

    .signature-box {
        width: 45%;
        text-align: center;
    }

    .signature-line {
        border-bottom: 2px solid #333;
        height: 40px;
        margin-bottom: 8mm;
    }

    .signature-label {
        font-size: 12px;
        color: #666;
        font-family: Arial, sans-serif;
    }
    
    /* Système de détection de débordement */
    .quittance-content {
        max-height: calc(100vh - 300px);
        overflow: hidden;
        position: relative;
    }
    
    /* Zone de contenu intelligente */
    .quittance-content::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 150px;
        background: transparent;
        pointer-events: none;
        z-index: 1;
    }
    
    .quittance-content::after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        height: 100px;
        background: transparent;
        pointer-events: none;
        z-index: 1;
    }
    
    /* Ajustement automatique de la taille des polices */
    @media (max-height: 600px) {
        .quittance-title { font-size: clamp(12px, 2vw, 16px) !important; }
        .quittance-number { font-size: clamp(8px, 1.5vw, 10px) !important; }
        .quittance-date { font-size: clamp(7px, 1.2vw, 9px) !important; }
        .section-header { font-size: clamp(10px, 1.8vw, 12px) !important; }
        .info-label, .info-value, .payment-info-label, .payment-info-value { 
            font-size: clamp(7px, 1.4vw, 9px) !important; 
        }
        .amount-value { font-size: clamp(14px, 3vw, 18px) !important; }
        .amount-label { font-size: clamp(8px, 1.5vw, 10px) !important; }
        .quittance-section, .payment-details { margin: 4px 0 !important; }
        .amount-section { margin: 6px 0 !important; }
    }
    
    @media (max-height: 500px) {
        .quittance-title { font-size: clamp(10px, 1.8vw, 14px) !important; }
        .quittance-number { font-size: clamp(7px, 1.3vw, 9px) !important; }
        .quittance-date { font-size: clamp(6px, 1.1vw, 8px) !important; }
        .section-header { font-size: clamp(8px, 1.6vw, 10px) !important; }
        .info-label, .info-value, .payment-info-label, .payment-info-value { 
            font-size: clamp(6px, 1.2vw, 8px) !important; 
        }
        .amount-value { font-size: clamp(12px, 2.5vw, 16px) !important; }
        .amount-label { font-size: clamp(7px, 1.3vw, 9px) !important; }
        .quittance-section, .payment-details { margin: 2px 0 !important; }
        .amount-section { margin: 4px 0 !important; }
    }

    .entreprise-footer {
        text-align: center;
        font-size: 11px;
        color: #666;
        border-top: none;
        padding-top: 4mm;
    }

    .entreprise-footer-info {
        line-height: 1.4;
        font-family: Arial, sans-serif;
    }

    /* Responsive */
    @media (max-width: 768px) {
        .quittance-container {
            margin: 0 1rem;
        }
        
        .info-grid,
        .payment-info {
            grid-template-columns: 1fr;
            gap: 4mm;
        }
        
        .quittance-header,
        .quittance-section,
        .payment-details,
        .quittance-footer {
            padding: 4mm 6mm;
        }
    }
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Système d'ajustement intelligent
    function adjustQuittanceContent() {
        const mainContent = document.querySelector('.quittance-main-content');
        const content = document.querySelector('.quittance-content');
        
        if (!mainContent || !content) return;
        
        // Calculer l'espace disponible pour format A5
        const viewportHeight = window.innerHeight;
        const headerElement = document.querySelector('.entreprise-header');
        const footerElement = document.querySelector('.entreprise-footer');
        const headerHeight = headerElement ? headerElement.offsetHeight : 60;
        const footerHeight = footerElement ? footerElement.offsetHeight : 50;
        const availableHeight = viewportHeight - headerHeight - footerHeight;
        
        // Ajuster la hauteur maximale du contenu principal
        mainContent.style.minHeight = availableHeight + 'px';
        
        // Détecter si le contenu déborde
        const contentHeight = content.scrollHeight;
        const isOverflowing = contentHeight > availableHeight;
        
        if (isOverflowing) {
            // Réduire progressivement la taille des polices
            const scaleFactor = Math.min(0.8, availableHeight / contentHeight);
            
            // Appliquer le facteur d'échelle à tous les éléments
            const elements = content.querySelectorAll('*');
            elements.forEach(element => {
                const currentFontSize = parseFloat(window.getComputedStyle(element).fontSize);
                if (currentFontSize > 0) {
                    element.style.fontSize = (currentFontSize * scaleFactor) + 'px';
                }
            });
            
            // Réduire les marges
            const sections = content.querySelectorAll('.quittance-section, .payment-details, .amount-section');
            sections.forEach(section => {
                section.style.margin = '2px 0';
            });
        }
    }
    
    // Ajuster au chargement
    adjustQuittanceContent();
    
    // Ajuster au redimensionnement
    window.addEventListener('resize', adjustQuittanceContent);
    
    // Ajuster après un délai pour s'assurer que tout est chargé
    setTimeout(adjustQuittanceContent, 100);
});
</script>
{% endblock %}

{% block content %}

<!-- Zone de contenu principal -->
<div class="quittance-main-content">
    <div class="quittance-page">
        <div class="quittance-container">
            <!-- Zone de contenu de la quittance - Style KBIS -->
            <div class="quittance-content">
                <!-- Contenu principal en deux colonnes -->
                <div class="quittance-main-grid">
                    <!-- Colonne gauche -->
                    <div class="quittance-left-column">
                        <div class="quittance-info">
                            <p><strong>RÉCÉPISSÉ N°:</strong> {{ quittance.numero_quittance }}</p>
                            <p><strong>code location :</strong> {{ quittance.paiement.contrat.propriete.numero }}</p>
                        </div>
                        
                        <div class="agency-stamp">
                            <p><strong>Cachet et signature de l'Agence:</strong></p>
                            <div class="stamp-placeholder">
                                <div class="stamp-circle">
                                    <div class="stamp-text">
                                        <strong>{{ config_entreprise.nom_entreprise }}</strong><br>
                                        {{ config_entreprise.ville }}<br>
                                        {% if config_entreprise.telephone %}{{ config_entreprise.telephone }}{% endif %}
                                        {% if config_entreprise.telephone_2 %} / {{ config_entreprise.telephone_2 }}{% endif %}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Colonne droite -->
                    <div class="quittance-right-column">
                        <div class="quittance-details">
                            <p><strong>Date:</strong> {{ quittance.date_emission|date:"d-m-y" }}</p>
                            <p><strong>Reçu de M:</strong> {{ quittance.paiement.contrat.locataire.nom_complet }}</p>
                            
                            <div class="amount-section">
                                <p><strong>Pour le versement de la somme de :</strong></p>
                                <div class="amount-box">
                                    {{ quittance.paiement.montant|floatformat:0 }} F
                                </div>
                                <p class="amount-words">( {{ quittance.paiement.montant|floatformat:0 }} )</p>
                            </div>
                            
                            <div class="payment-summary">
                                <div class="summary-row">
                                    <span><strong>Mois Reglé:</strong></span>
                                    <span>{{ quittance.paiement.mois_paye|date:"F Y" }}</span>
                                </div>
                                <div class="summary-row">
                                    <span><strong>Restant dû:</strong></span>
                                    <span>0 F</span>
                                </div>
                                <div class="summary-row">
                                    <span><strong>loyer au pro-rata à régler :</strong></span>
                                    <span>0 F</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Signatures tout en bas -->
                <div class="quittance-footer">
                    <div class="signature-section">
                        <div class="signature-box">
                            <div class="signature-line"></div>
                            <p class="signature-label">Signature du Gérant</p>
                        </div>
                        <div class="signature-box">
                            <div class="signature-line"></div>
                            <p class="signature-label">Signature du locataire</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<!-- Notes supplémentaires si nécessaire -->
{% if quittance.paiement.notes %}
<div class="quittance-main-content">
    <div class="quittance-page">
        <div class="quittance-container">
            <div class="quittance-content">
                <!-- Notes supplémentaires -->
                <div class="quittance-section">
                    <div class="section-header">
                        <h5>Notes et Observations</h5>
                    </div>
                    <div class="info-grid">
                        <div class="info-item">
                            <span class="info-label">Notes:</span>
                            <span class="info-value">{{ quittance.paiement.notes|linebreaks }}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endif %}
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Bouton d'impression
    const printButton = document.getElementById('print-button');
    if (printButton) {
        printButton.addEventListener('click', function() {
            window.print();
        });
    }
});
</script>
{% endblock %}