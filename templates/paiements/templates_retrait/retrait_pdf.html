<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Retrait Bailleur - {{ config.nom_entreprise }}</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 0; 
            padding: 20px; 
            background: white;
        }
        
        .header { 
            text-align: center; 
            margin-bottom: 30px; 
            border-bottom: 3px solid #3498db;
            padding-bottom: 20px;
        }
        
        .logo { 
            max-width: 150px; 
            height: auto; 
            margin-bottom: 10px;
        }
        
        .title { 
            font-size: 24px; 
            font-weight: bold; 
            color: #2c3e50; 
            margin: 20px 0; 
        }
        
        .subtitle { 
            font-size: 18px; 
            color: #7f8c8d; 
            margin-bottom: 30px; 
        }
        
        .info-section { 
            margin: 20px 0; 
        }
        
        .info-title { 
            font-size: 16px; 
            font-weight: bold; 
            color: #34495e; 
            margin-bottom: 10px; 
            border-left: 4px solid #3498db;
            padding-left: 10px;
        }
        
        .info-content { 
            background: #f8f9fa; 
            padding: 15px; 
            border-radius: 5px; 
            border: 1px solid #e9ecef;
        }
        
        .table { 
            width: 100%; 
            border-collapse: collapse; 
            margin: 20px 0; 
        }
        
        .table th, .table td { 
            border: 1px solid #ddd; 
            padding: 12px; 
            text-align: left; 
        }
        
        .table th { 
            background: #3498db; 
            color: white; 
            font-weight: bold; 
        }
        
        .table tr:nth-child(even) { 
            background: #f2f2f2; 
        }
        
        .total-section { 
            margin-top: 30px; 
            padding: 20px; 
            background: #ecf0f1; 
            border-radius: 5px; 
            border: 2px solid #bdc3c7;
        }
        
        .total-line { 
            display: flex; 
            justify-content: space-between; 
            margin: 10px 0; 
            padding: 5px 0;
        }
        
        .total-final { 
            font-size: 18px; 
            font-weight: bold; 
            color: #27ae60; 
            border-top: 2px solid #27ae60; 
            padding-top: 10px; 
        }
        
        .footer { 
            margin-top: 50px; 
            text-align: center; 
            font-size: 12px; 
            color: #7f8c8d; 
            border-top: 1px solid #bdc3c7;
            padding-top: 20px;
        }
        
        .status-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
            text-transform: uppercase;
        }
        
        .status-en-attente {
            background: #f39c12;
            color: white;
        }
        
        .status-valide {
            background: #27ae60;
            color: white;
        }
        
        .status-refuse {
            background: #e74c3c;
            color: white;
        }
        
        .montant {
            font-weight: bold;
            color: #2c3e50;
        }
        
        .montant-positif {
            color: #27ae60;
        }
        
        .montant-negatif {
            color: #e74c3c;
        }
    </style>
</head>
<body>
    <div class="header">
        {% if config.logo %}
        <img src="{{ config.logo.url }}" alt="Logo" class="logo">
        {% endif %}
        <h1 class="title">{{ config.nom_entreprise }}</h1>
        <p class="subtitle">RETRAIT BAILLEUR - {{ retrait.mois_retrait|date:"F Y"|upper }}</p>
        <p><strong>Numéro de retrait:</strong> {{ retrait.numero_retrait|default:"N/A" }}</p>
    </div>
    
    <div class="info-section">
        <h3 class="info-title">Informations du Bailleur</h3>
        <div class="info-content">
            <p><strong>Nom:</strong> {{ retrait.bailleur.get_nom_complet }}</p>
            <p><strong>Email:</strong> {{ retrait.bailleur.email|default:"Non renseigné" }}</p>
            <p><strong>Téléphone:</strong> {{ retrait.bailleur.telephone|default:"Non renseigné" }}</p>
            <p><strong>Adresse:</strong> {{ retrait.bailleur.adresse|default:"Non renseignée" }}</p>
        </div>
    </div>
    
    <div class="info-section">
        <h3 class="info-title">Informations du Retrait</h3>
        <div class="info-content">
            <p><strong>Mois de retrait:</strong> {{ retrait.mois_retrait|date:"F Y" }}</p>
            <p><strong>Date de demande:</strong> {{ retrait.date_demande|date:"d/m/Y" }}</p>
            <p><strong>Statut:</strong> 
                <span class="status-badge status-{{ retrait.statut }}">
                    {{ retrait.get_statut_display }}
                </span>
            </p>
            <p><strong>Type de retrait:</strong> {{ retrait.get_type_retrait_display }}</p>
            <p><strong>Mode de retrait:</strong> {{ retrait.get_mode_retrait_display }}</p>
        </div>
    </div>
    
    <div class="info-section">
        <h3 class="info-title">Détail des Propriétés</h3>
        <table class="table">
            <thead>
                <tr>
                    <th>Propriété</th>
                    <th>Adresse</th>
                    <th>Loyer Brut</th>
                    <th>Charges Déductibles</th>
                    <th>Charges Bailleur</th>
                    <th>Net à Payer</th>
                </tr>
            </thead>
            <tbody>
                {% for propriete in donnees.proprietes %}
                <tr>
                    <td>{{ propriete.propriete.titre }}</td>
                    <td>{{ propriete.propriete.adresse }}</td>
                    <td class="montant montant-positif">{{ propriete.loyer_brut|floatformat:0 }} F CFA</td>
                    <td class="montant montant-negatif">- {{ propriete.charges_deductibles|floatformat:0 }} F CFA</td>
                    <td class="montant montant-negatif">- {{ propriete.charges_bailleur|floatformat:0 }} F CFA</td>
                    <td class="montant montant-positif">{{ propriete.montant_net|floatformat:0 }} F CFA</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    
    <div class="total-section">
        <h3 class="info-title">Récapitulatif Financier</h3>
        <div class="total-line">
            <span>Total Loyers Bruts:</span>
            <span class="montant montant-positif">{{ donnees.total_loyers_bruts|floatformat:0 }} F CFA</span>
        </div>
        <div class="total-line">
            <span>Total Charges Déductibles:</span>
            <span class="montant montant-negatif">- {{ donnees.total_charges_deductibles|floatformat:0 }} F CFA</span>
        </div>
        <div class="total-line">
            <span>Total Charges Bailleur:</span>
            <span class="montant montant-negatif">- {{ donnees.total_charges_bailleur|floatformat:0 }} F CFA</span>
        </div>
        <div class="total-line total-final">
            <span>MONTANT NET À PAYER:</span>
            <span class="montant montant-positif">{{ donnees.montant_net_total|floatformat:0 }} F CFA</span>
        </div>
    </div>
    
    {% if retrait.notes %}
    <div class="info-section">
        <h3 class="info-title">Notes</h3>
        <div class="info-content">
            <p>{{ retrait.notes }}</p>
        </div>
    </div>
    {% endif %}
    
    <div class="footer">
        <p><strong>Document généré le {{ date_generation|date:"d/m/Y à H:i" }}</strong></p>
        <p>{{ config.nom_entreprise }} - {{ config.adresse|default:"" }}</p>
        {% if config.telephone %}
        <p>Téléphone: {{ config.telephone }}</p>
        {% endif %}
        {% if config.email %}
        <p>Email: {{ config.email }}</p>
        {% endif %}
    </div>
</body>
</html>

